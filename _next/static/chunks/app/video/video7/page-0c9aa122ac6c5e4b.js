(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[985],{4413:function(e,t,n){Promise.resolve().then(n.bind(n,3882))},3882:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return g}});var r=n(7437),u=n(2265),c=n(3915),o=n(7776),s=n(6089),a=n(5780);let l=e=>{let{src:t,volume:n}=e,[l,d]=u.useState(!1);(0,u.useEffect)(()=>{navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(e=>{console.log("getUserMedia: ",e),e.getTracks().forEach(e=>e.stop()),d(!0)}).catch(e=>{console.error("getUserMedia error: ",e)})},[]);let f=(0,u.useMemo)(()=>{let e=document.createElement("video");return e.crossOrigin="anonymous",e.playsInline=!0,e.loop=!0,e},[]),m=(0,u.useMemo)(()=>new o.VideoTexture(f),[f]),g=(0,u.useMemo)(()=>{let e=new c.ZP;return e.attachMedia(f),e},[f]);(0,u.useEffect)(()=>()=>{g.destroy()},[g]);let v=(0,u.useRef)(null),p=(0,u.useRef)(null),h=(0,u.useRef)(null),E=(0,u.useRef)(null);(0,u.useEffect)(()=>{let e=()=>{l&&(null===v.current&&(v.current=new AudioContext,p.current=v.current.createGain(),h.current=new MediaElementAudioSourceNode(v.current,{mediaElement:f}),h.current.connect(p.current),p.current.connect(v.current.destination),p.current.gain.value=n,console.log("connected"),E.current=new AnalyserNode(v.current,{fftSize:2048}),p.current.connect(E.current)),console.log("audioContextRef.current.state: ",v.current.state,"mediaElementSourceRef.current: ",h.current),v.current.resume(),f.play())};return window.addEventListener("click",e),()=>{window.removeEventListener("click",e)}},[n,f,l]),(0,u.useEffect)(()=>{null!==p.current&&(p.current.gain.value=n,console.log("volume changed: ",n))},[n]),(0,u.useEffect)(()=>(i()&&f.canPlayType("application/vnd.apple.mpegurl")?(f.src=t,console.log("Safari native HLS")):c.ZP.isSupported()?(g.loadSource(t),console.log("Hls.js")):console.error("HLS is not supported."),()=>{f.pause()}),[f,g,t]);let x=(0,u.useRef)(new Float32Array(2048));return(0,a.F)(()=>{null!==E.current&&(E.current.getFloatTimeDomainData(x.current),console.log("dataArray sum: ",x.current.reduce((e,t)=>e+t,0)))}),(0,r.jsx)(s.JO,{args:[16,9],children:(0,r.jsx)("meshBasicMaterial",{map:m})})},i=()=>/^((?!chrome|android).)*safari/i.test(navigator.userAgent);var d=n(7585),f=n(381),m=n.n(f);function g(){(0,u.useEffect)(()=>{new(m())},[]);let[e,t]=(0,u.useState)(.5),[n,c]=(0,u.useState)(!0);return(0,u.useEffect)(()=>{let e=()=>{n&&(c(!n),console.log("muted: ",!n))};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[n]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("input",{type:"range",min:0,max:1,step:.01,value:e,onChange:e=>{t(parseFloat(e.target.value))}}),(0,r.jsx)("div",{style:{height:"95dvh"},children:(0,r.jsx)(d.Xz,{children:(0,r.jsx)(l,{src:"https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8",volume:e,muted:n})})})]})}}},function(e){e.O(0,[104,689,404,540,971,23,744],function(){return e(e.s=4413)}),_N_E=e.O()}]);